{"version":3,"sources":["core.js"],"names":["clickHandler","event","target","exe","e","logging","console","log","nodeName","getAttribute","substring","internalLinkWasClicked","externalLinkWasClicked","className","indexOf","onpageLinkHandler","linkWasClicked","backButtonWasClicked","currentPage","url","portfolioHandler","imageWasClicked","clickedAgain","parentElement","clickedAgainP","preventDefault","stopPropagation","historical","ctrlKey","shiftKey","metaKey","button","newTabUrl","win","window","open","focus","alert","loadPage","link","element","backButton","distanceToTop","document","querySelector","classList","add","scrollIntoViewAndHighlight","oldBackButton","removeBackButton","createElement","scrollY","innerHTML","setTimeout","appendChild","addEventListener","runOnScroll","scrollIntoView","remove","d","Math","abs","threshold","style","opacity","removeChild","removeEventListener","hideLoadingNotification","loadingNotification","runAfterPageLoadsCore"],"mappings":"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","file":"core.js","sourcesContent":["// core.js - JS that can run after content is loaded\n////////////////////////////////////////////////////////////////////////////////\n\n// Handles all the clicks on the page. Decides which function to call when something is clicked.\nvar clickHandler = {\n    event: {},\n    target: {}\n\n    // Chooses which function to call, based on what was clicked etc.\n    // Called by event listener, so [this] != clickHandler.\n    ,exe: function(e) {                     // e(vent)\n        clickHandler.event = e;             // Set event\n        clickHandler.target = e.target;     // Set target\n\n        if(logging===true) {\n            console.log(\"clickHandler: Something was clicked\");\n            console.log(\"    event: \", e);\n            console.log(\"    target: \", e.target, \"\\n\\n\");\n        }\n\n        // Internal link: Check if target is an <a> and href starts with [#/]\n        if(e.target.nodeName === \"A\" && e.target.getAttribute(\"href\").substring(0,2) === \"#/\") {\n            clickHandler.internalLinkWasClicked(e.target); \n        }\n\n        // External link: Check if target is an <a> and first char in href is not [#]\n        if(e.target.nodeName === \"A\" && e.target.getAttribute(\"href\").substring(0,1) !== \"#\") {\n            clickHandler.externalLinkWasClicked(e.target); \n        }\n\n        // On-page link\n        if(e.target.className.indexOf(\"u-link-onpage\") !== -1) onpageLinkHandler.linkWasClicked(e.target);\n        if(e.target.className.indexOf(\"u-backbutton-link-onpage\") !== -1) onpageLinkHandler.backButtonWasClicked();\n\n        // Portfolio\n        if(currentPage.url === \"/_work.html\") {\n            // Portfolio image is clicked\n            if(e.target.className.indexOf(\"portfolio-image\") !== -1 ) {\n                portfolioHandler.imageWasClicked(e.target);\n            }\n            // Caption text is clicked\n            if(e.target.className.indexOf(\"portfolio-caption\") !== -1 ) {\n                portfolioHandler.clickedAgain(e.target);\n            }\n            // Caption box *containing* the text is clicked (the Parent element)\n            if(e.target.parentElement.className.indexOf(\"portfolio-caption\") !== -1 ) {\n                portfolioHandler.clickedAgainP(e.target);\n            }\n        }\n\n    } // end exe\n\n    // Run when an internal link is clicked (a williams.blue link)\n    ,internalLinkWasClicked: function(target) {\n        this.event.preventDefault();            // Prevent unwanted default behavior. [this] = clickHandler.\n        this.event.stopPropagation();           // We're done with the event now\n        var url = this.target.getAttribute(\"href\").substring(1); // Url from root, eg [/_me.html]. No hash.\n\n        // If a link is clicked, we're not moving through history anymore.\n        currentPage.historical = false;\n\n        // Detect if user wanted to open link in new tab\n        if( this.event.ctrlKey || \n            this.event.shiftKey || \n            this.event.metaKey ||                           // Apple command key\n            (this.event.button && this.event.button == 1)   // Middle click\n        ) {\n            var newTabUrl = \"/index.html#\" + url;           // Create off-page link\n            var win = window.open(newTabUrl, \"_blank\");     // Create new tab\n            if(win) {           // If we were able to create the new tab (eg wasn't blocked by popup blocker)\n                win.focus();    // Go to new tab\n                return;         // Return from function so that content is not loaded in original page.\n            } else alert(\"Could not open link in new tab. Maybe it was blocked by your popup blocker.\");\n        }\n\n        loadPage(url);      // Load content in current page.\n    }\n\n    // Run when an external link is clicked (not a williams.blue link)\n    ,externalLinkWasClicked: function(target) {\n        this.event.preventDefault();            // Prevent unwanted default behavior. [this] = clickHandler.\n        this.event.stopPropagation();           // We're done with the event now\n        var url = this.target.getAttribute(\"href\");\n\n        var win = window.open(url, \"_blank\");     // Create new tab\n        if(win) {           // If we were able to create the new tab (eg wasn't blocked by popup blocker)\n            win.focus();    // Go to new tab\n        } else alert(\"Could not open link in new tab. Maybe it was blocked by your popup blocker.\");        \n    }\n};\n\nvar onpageLinkHandler = {\n\n    link: {}\n    ,element: {}\n    ,backButton: {\n        distanceToTop: 0\n    }\n\n    ,linkWasClicked: function(link) {\n        // The link that was clicked. Make it accessible by other functions.\n        this.link = link;\n\n        // The destination element\n        // Get the destination element via the data of the clicked element.\n        var element = document.querySelector(link.getAttribute(\"data-link-onpage\"));\n        this.element = element; // Make it accessible by other functions.\n\n        element.classList.add(\"u-position-relative\");  // So we can position the button next to it\n\n        this.scrollIntoViewAndHighlight(element);\n        \n        // Check if back button already exists. Remove if it does.\n        var oldBackButton = document.querySelector(\".u-backbutton-link-onpage\");\n        if(oldBackButton) this.removeBackButton(oldBackButton);\n\n        // Creates a button that will take the user back to the previous element they were looking at.\n        // The button is displayed adjacent to the new element.\n        this.backButton = document.createElement(\"button\");     // Create back button\n        var backButton = this.backButton;                       // Less typing\n        backButton.distanceToTop = window.scrollY;              // Get current distance from top of page\n        backButton.classList.add(\"u-button-simple\", \"u-backbutton-link-onpage\");\n        backButton.innerHTML = \"Go back\";\n\n        // Back button appears after highlight disappears (1.5s). Scroll event listener is attached\n        window.setTimeout(function(){\n            element.appendChild(backButton);  // Back button appears after element highlighted\n\n            // Back button will fade away on scroll. Event listener is attached after highlight disappears.\n            // Function needs to know where on the page we started and what button we're looking at.\n            window.addEventListener(\"scroll\", onpageLinkHandler.runOnScroll);\n        }, 1500);\n    }\n\n    ,backButtonWasClicked: function() {\n        this.scrollIntoViewAndHighlight(this.link);     // Scroll back to previous element when clicked\n        this.removeBackButton(this.backButton);         // Remove the back button and scroll listener\n    }\n\n    ,scrollIntoViewAndHighlight: function(element) {\n        element.scrollIntoView();                       // Scroll element into view\n        element.classList.add(\"u-_lookatme\");           // Make element noticeable\n\n        window.setTimeout(function() {                  // Remove noticeable class after 1.5s\n            element.classList.remove(\"u-_lookatme\");\n        }, 1500);\n    }\n\n    ,runOnScroll: function() {\n        var backButton = onpageLinkHandler.backButton; // Less typing\n\n        // Get distance scrolled away from back button\n        var d = window.scrollY - backButton.distanceToTop;\n\n        d = Math.abs(d);                                // Make sure value is positive (distance)\n        var threshold = 300;                            // Threshold to remove the button (in px)\n\n        // Back button disappears as user scrolls away. It's completely gone when threshold is reached.\n        backButton.style.opacity = (threshold - d) / threshold;\n\n        // If user scrolls past the threshold, remove the back button etc\n        if( d > threshold) {\n            onpageLinkHandler.removeBackButton();\n        }\n    }\n\n    // Remove back button and other stuff we used.\n    ,removeBackButton: function() {\n        this.backButton.parentElement.classList.remove(\"u-position-relative\");\n        this.backButton.parentElement.removeChild(this.backButton);\n        window.removeEventListener(\"scroll\", onpageLinkHandler.runOnScroll);\n    }\n};\n\nfunction hideLoadingNotification(){\n    loadingNotification.classList += \" u-_is-absent\";\n};\n\n////////////////////////////////////////////////////////////////////////////////\n// code that runs\n\n// Runs after page is loaded\n(function runAfterPageLoadsCore() {\n    // hideLoadingNotification();\n})();"]}